# 🎨 Z-Index 层级管理

## 📊 层级结构

为了确保UI元素正确显示，项目中的 z-index 按照以下层级组织：

---

## 🏗️ 层级定义

### 第0层：基础层 (z-index: 0-10)
**用途**：页面基础元素和背景

| 元素 | z-index | 说明 |
|------|---------|------|
| `body::after` | 0 | 背景渐变层 |
| `header` | 10 | 页头区域 |
| `.stats-panel` | 10 | 统计面板 |
| `.filter-controls` | 10 | 筛选按钮组 |
| `.sort-controls` | 10 | 排序按钮组 |
| `.movie-grid` | 10 | 电影网格 |

---

### 第1层：卡片层 (z-index: 2-10)
**用途**：电影卡片和内部元素

| 元素 | z-index | 说明 |
|------|---------|------|
| `.banner-content` | 2 | 模态框横幅内容 |
| `.preview-player` | 5 | 预告片播放按钮 |
| `.status-badge` | 10 | 状态徽章 |
| `.delete-btn` | 10 | 删除按钮 |

---

### 第2层：模态框层 (z-index: 1000-1001)
**用途**：弹出式模态框

| 元素 | z-index | 说明 |
|------|---------|------|
| `.modal` | 1000 | 电影详情模态框 |
| `.close-btn` | 1001 | 模态框关闭按钮 |

---

### 第3层：下拉菜单层 (z-index: 9000)
**用途**：下拉式选择器和设置面板

| 元素 | z-index | 说明 |
|------|---------|------|
| `.theme-selector` | 9000 | 主题选择器 |
| `.font-selector` | 9000 | 字体选择器 |
| `.lang-selector` | 9000 | 语言选择器 |
| `.settings-panel` | 9000 | 设置面板 |

---

### 第4层：搜索层 (z-index: 9999-10001)
**用途**：搜索框和搜索建议

| 元素 | z-index | 说明 |
|------|---------|------|
| `.search-box` | 9999 | 搜索框容器 |
| `.search-suggestions` | 10001 | **搜索建议下拉框（最高优先级）** |

---

### 第5层：通知层 (z-index: 10000)
**用途**：全局通知提示

| 元素 | z-index | 说明 |
|------|---------|------|
| `.notification` | 10000 | 通知消息 |

---

## 🎯 设计原则

### 1. 层级递增原则
- 基础内容：0-10
- 交互元素：100-1000
- 弹出元素：1000-9000
- 关键UI：9000-10000
- 系统通知：10000+

### 2. 搜索优先原则
**搜索建议框必须始终可见**，因此：
- 搜索框：9999
- 搜索建议：10001（仅次于通知）

### 3. 避免冲突原则
- 同类元素使用相同 z-index
- 不同层级间隔足够大（至少100）
- 避免使用过大的数值

---

## 🔧 修改指南

### 添加新元素时

1. **确定元素类型**
   - 基础内容？→ 0-10
   - 下拉菜单？→ 9000
   - 模态框？→ 1000
   - 通知？→ 10000

2. **检查是否需要覆盖其他元素**
   - 需要覆盖所有内容？→ 使用更高的 z-index
   - 只需要覆盖部分内容？→ 使用适当的层级

3. **测试层级关系**
   - 打开所有下拉菜单
   - 打开搜索建议
   - 打开模态框
   - 显示通知
   - 确保没有遮挡问题

---

## ⚠️ 常见问题

### Q: 为什么搜索建议框的 z-index 这么高？
**A**: 搜索建议框是用户输入时最重要的交互元素，必须确保它始终可见，不被任何其他元素遮挡。

### Q: 为什么不把所有下拉菜单都设置为 10000+？
**A**: 
- 保持合理的层级结构
- 避免 z-index 值过大
- 搜索建议需要最高优先级
- 其他下拉菜单不需要那么高

### Q: 如果添加新的下拉菜单应该用什么 z-index？
**A**: 
- 普通下拉菜单：9000
- 搜索相关：9999-10001
- 系统级通知：10000

### Q: position: absolute 的元素 z-index 会受父元素影响吗？
**A**: 
- 是的！如果父元素的 z-index 较低，子元素即使设置很高的 z-index 也可能被遮挡
- 解决方法：同时提升父元素和子元素的 z-index

---

## 📝 修改历史

### 2026-01-28 - 修复搜索建议遮挡问题
- `.search-box`: 10 → 9999
- `.search-suggestions`: 1001 → 10001
- `.theme-selector`: 100 → 9000
- `.font-selector`: 100 → 9000
- `.lang-selector`: 100 → 9000
- `.settings-panel`: 100 → 9000

**原因**：搜索建议框被统计面板、筛选按钮等元素遮挡

**解决方案**：
1. 提升搜索框容器的 z-index 到 9999
2. 提升搜索建议框的 z-index 到 10001
3. 提升所有下拉菜单到 9000

---

## 🎨 视觉层级示意

```
┌─────────────────────────────────────┐
│  通知层 (10000)                      │  ← 最顶层
├─────────────────────────────────────┤
│  搜索建议 (10001)                    │  ← 搜索最优先
│  搜索框 (9999)                       │
├─────────────────────────────────────┤
│  下拉菜单 (9000)                     │  ← 设置、主题等
│  - 主题选择器                        │
│  - 字体选择器                        │
│  - 语言选择器                        │
│  - 设置面板                          │
├─────────────────────────────────────┤
│  模态框 (1000-1001)                  │  ← 详情、笔记等
│  - 电影详情                          │
│  - 笔记编辑                          │
│  - 评分设置                          │
├─────────────────────────────────────┤
│  页面内容 (0-10)                     │  ← 基础内容
│  - 统计面板                          │
│  - 筛选按钮                          │
│  - 电影卡片                          │
│  - 背景                              │
└─────────────────────────────────────┘
```

---

## ✅ 检查清单

在修改 z-index 时，请确保：

- [ ] 搜索建议框始终在最上层（除了通知）
- [ ] 下拉菜单不被页面内容遮挡
- [ ] 模态框覆盖所有页面内容
- [ ] 通知消息在最顶层
- [ ] 没有使用过大的 z-index 值
- [ ] 同类元素使用相同的 z-index
- [ ] 测试了所有可能的UI组合

---

**维护者注意**：修改任何 z-index 时，请更新此文档！

**版本**: v2.1.0  
**最后更新**: 2026-01-28
